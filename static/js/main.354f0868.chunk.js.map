{"version":3,"sources":["components/Table/Table.module.css","components/App.module.css","components/ResultWindow/ResultWindow.module.css","components/Input/Input.module.css","components/Button/Button.module.css","components/Table/Table.js","components/Button/Button.js","components/ResultWindow/ResultWindow.js","components/Game/Game.js","components/Input/Input.js","components/App.js","index.js"],"names":["module","exports","Table","message","scale","onCellClick","shotView","className","styles","tableWrap","table","arrayRow","arrayCell","i","push","map","key","num","classnames","cell","hit","hitView","indexOf","miss","missView","sunk","sunkView","id","onClick","generateBoard","Button","text","button","ResultWindow","shots","ships","wrap","title","document","location","reload","Game","boardSize","shipLength","shipAmount","useState","setHitView","setMissView","setSunkView","setMessage","shipsSunk","setShipsSunk","endGame","setEndGame","collision","shipsArr","length","j","locations","generateShipLocations","row","col","direction","Math","floor","random","newShip","newShips","newLocations","isSunk","generateShips","setShips","useEffect","forEach","ship","every","point","e","target","some","newArr","isHit","Input","value","placeholder","onChangeInput","error","label","type","input","onChange","App","startWindow","setStartWindow","setBoardSize","setShipAmount","setError","startTheGame","onKeyDown","keyCode","inputsWrap","errorMessage","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.354f0868.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"message\":\"Table_message__1_pGp\",\"tableWrap\":\"Table_tableWrap__3gxLd\",\"table\":\"Table_table__28TwD\",\"cell\":\"Table_cell__-IGHO\",\"miss\":\"Table_miss__3Ft-t\",\"hit\":\"Table_hit__2Izhg\",\"sunk\":\"Table_sunk__v56t-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"App_title__3qFBo\",\"wrap\":\"App_wrap__1f6FR\",\"inputsWrap\":\"App_inputsWrap__1ffIn\",\"startWindow\":\"App_startWindow__tcwsi\",\"errorMessage\":\"App_errorMessage__3QB8t\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"ResultWindow_title__3dtRW\",\"text\":\"ResultWindow_text__NSMKI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"Input_input__1WIGj\",\"error\":\"Input_error__320qJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button__zIcgS\"};","import React from 'react';\r\nimport styles from './Table.module.css';\r\nimport classnames from 'classnames';\r\nimport PropTypes from 'prop-types';\r\n\r\nconst Table = ({ message, scale, onCellClick, shotView  }) => {\r\n  \r\n  const generateBoard = scale => {\r\n    const arrayRow = [];\r\n    const arrayCell = [];\r\n\r\n    for (let i = 0; i<scale; ++i) {\r\n      arrayRow.push(i);\r\n      arrayCell.push(i);\r\n    }\r\n    \r\n    return arrayRow.map(i => (\r\n          <tr key={`${i}row`}>\r\n            {arrayCell.map(num => (\r\n              <td \r\n                className={classnames({\r\n                  [styles.cell]: true,\r\n                  [styles.hit]: shotView.hitView.indexOf(`${i}${num}`) !== -1,                  \r\n                  [styles.miss]: shotView.missView.indexOf(`${i}${num}`) !== -1,\r\n                  [styles.sunk]: shotView.sunkView.indexOf(`${i}${num}`) !== -1,\r\n                })}\r\n                id={`${i}${num}`}\r\n                key={`${i}${num}`}\r\n                onClick={onCellClick}\r\n              />\r\n            ))}\r\n          </tr>\r\n        )\r\n      );\r\n  };\r\n  \r\n  return (\r\n    <div className={styles.tableWrap}>\r\n    <h2 className={styles.message}>{message}</h2>\r\n    <table className={styles.table}>        \r\n        <tbody>\r\n        {generateBoard(scale)}            \r\n        </tbody>\r\n    </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nTable.propTypes = {\r\n    message: PropTypes.string.isRequired,\r\n    scale: PropTypes.number.isRequired,\r\n    onCellClick: PropTypes.func,\r\n    shotView: PropTypes.object\r\n}\r\n\r\nexport default Table;\r\n","import React from 'react';\r\nimport styles from './Button.module.css';\r\n\r\nconst Button = ({ text, onClick }) => (\r\n    <button \r\n    className={styles.button}\r\n    onClick={onClick}\r\n>\r\n    {text}\r\n</button>\r\n);\r\n\r\nexport default Button;\r\n","import React from 'react';\r\nimport styles from './ResultWindow.module.css';\r\nimport Button from '../Button/Button';\r\n\r\nconst ResultWindow = ({ shots, ships }) => (\r\n  <div className={styles.wrap}>\r\n      <h2 className={styles.title}>Конец игры.<br />Результат:</h2>      \r\n      <p className={styles.text}>\r\n        Потоплено кораблей: {ships}<br />\r\n        Выстрелов сделано: {shots}\r\n      </p>\r\n      <Button \r\n        text={'Сыграть снова'}\r\n        onClick={() => document.location.reload()}\r\n      />\r\n  </div>\r\n);\r\n\r\nexport default ResultWindow;\r\n","import React, { useEffect, useState } from 'react';\r\nimport Table from '../Table/Table';\r\nimport ResultWindow from '../ResultWindow/ResultWindow';\r\n\r\nconst Game = ({ boardSize, shipLength, shipAmount }) => {\r\n\r\n  const [hitView, setHitView] = useState([]);\r\n  const [missView, setMissView] = useState([]);\r\n  const [sunkView, setSunkView] = useState([]);\r\n  const [message, setMessage] = useState('Нажми на клетку, чтобы сделать выстрел');\r\n  let [shipsSunk, setShipsSunk] = useState(0);\r\n  const [endGame, setEndGame] = useState(false);\r\n  \r\n  // проверка пересечений кораблей\r\n  const collision = (shipsArr, location) => {\r\n    for (let i = 0; i < shipsArr.length; i++) {\r\n     for (let j = 0; j < location.length; j++) {\r\n         if (shipsArr[i].locations.indexOf(location[j]) >= 0) {\r\n             return true;\r\n         }\r\n       }\r\n    }\r\n    return false;\r\n };\r\n\r\n  const generateShipLocations = () => {\r\n    const direction = Math.floor(Math.random() * 2);  // 1 - горизонтальный корабль, 0 - вертикальный\r\n    let row, col;\r\n    \r\n    // генерация начальной позиции корабля\r\n    if (direction === 1) {\r\n      row = Math.floor(Math.random() * boardSize);\r\n      col = Math.floor(Math.random() * (boardSize - shipLength));\r\n    } else {\r\n      row = Math.floor(Math.random() * (boardSize - shipLength));\r\n      col = Math.floor(Math.random() * boardSize);\r\n    }\r\n\r\n    const newShip = [];\r\n    for (let i = 0; i < shipLength; ++i) {\r\n      (direction === 1) ? newShip.push(`${row}${col + i}`) \r\n        : newShip.push(`${row + i}${col}`)\r\n    }\r\n\r\n    return newShip;\r\n  };\r\n\r\n  const generateShips = () => {\r\n    const newShips = [];\r\n\r\n    for (let i = 0; i < shipAmount; ++i) {\r\n      const newLocations = generateShipLocations();\r\n      if (!collision(newShips, newLocations)) {\r\n        const newShip = { locations: newLocations, isSunk: false};\r\n        newShips.push(newShip);\r\n      } else i--;\r\n    };\r\n    \r\n    return newShips;\r\n  };  \r\n  \r\n  const [ships, setShips] = useState(generateShips());\r\n\r\n  const isHit = id => {\r\n    const result = ships.some( ship => {\r\n      if (ship.locations.indexOf(id) !== -1) {\r\n        const newArr = [...hitView];\r\n        newArr.push(id);\r\n\r\n        setHitView(newArr);\r\n        setMessage('Корабль подбит!');\r\n        return ship;\r\n      }\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  const onCellClick = e => {\r\n    const id = e.target.id; \r\n        \r\n    if (hitView.indexOf(id) === -1) {      \r\n      if (!isHit(id)) {\r\n        if (missView.indexOf(id) === -1) {\r\n          const newArr = [...missView];\r\n          newArr.push(id);\r\n\r\n          setMissView(newArr);\r\n          setMessage('Мимо!');\r\n        }\r\n      };\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const newShips = [...ships];\r\n\r\n    newShips.forEach( ship => {\r\n      if (!ship.isSunk) {\r\n        const isSunk = ship.locations.every( point => hitView.indexOf(point) !== -1);\r\n        if (isSunk) {\r\n          setShipsSunk(++shipsSunk);\r\n          ship.isSunk = true;\r\n          setSunkView([...sunkView, ...ship.locations]);\r\n\r\n          setMessage(`Корбаль затоплен! Потоплен ${shipsSunk}й корабль`);\r\n        }\r\n      }\r\n    });\r\n    setShips(newShips);\r\n    if (ships.every(ship => ship.isSunk)) setEndGame(true);\r\n\r\n\r\n  }, [hitView]);\r\n\r\n  return (\r\n    <>\r\n      {endGame ? \r\n        <ResultWindow \r\n          shots={hitView.length + missView.length}\r\n          ships={shipsSunk}\r\n        />\r\n      :\r\n        <Table \r\n          message={message}\r\n          scale={+boardSize}\r\n          onCellClick={onCellClick}\r\n          shotView={{\r\n            hitView: hitView,\r\n            missView: missView,\r\n            sunkView:sunkView\r\n          }}\r\n        />\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Game;\r\n","import React from 'react';\r\nimport styles from './Input.module.css';\r\nimport classnames from 'classnames';\r\n\r\nconst Input = ({ value, placeholder, onChangeInput, error, label }) => (    \r\n    <input \r\n        type=\"text\"\r\n        value={value}\r\n        placeholder={placeholder}\r\n        className={classnames({\r\n            [styles.input]: true,\r\n            [styles.error]: error\r\n        }\r\n        )}\r\n        onChange={onChangeInput}\r\n    />\r\n);\r\n\r\nexport default Input;\r\n","import React, { useState } from 'react';\nimport styles from './App.module.css';\nimport Game from './Game/Game';\nimport Button from './Button/Button';\nimport Input from './Input/Input';\n\nconst App = () => {\n\n  const [startWindow, setStartWindow] = useState(true);\n  const [boardSize, setBoardSize] = useState('');\n  const [shipAmount, setShipAmount] = useState('');\n  const [error, setError] = useState('');\n\n  const shipLength = 3;\n\n  const startTheGame = () => {\n\n    switch(true) {\n      case (!boardSize || !shipAmount):\n        setError('Заполнены не все поля!');\n        break;\n      case ((+boardSize ^ 0) !== +boardSize):\n        setError('Размер доски должен быть целым числом!');\n        break;\n      case ((+boardSize ^ 0) !== +shipAmount):\n        setError('Количество кораблей должно быть целым числом!');\n        break;\n      case (+boardSize < +shipLength):\n        setError('Размер доски не может быть меньше корабля!');\n        break;\n      case (+shipAmount > +boardSize):\n          setError('Многовато кораблей!');\n          break;\n      default:\n        setStartWindow(false);\n    }\n\n  } \n\n  return (\n    <main className={styles.wrap}>\n      {startWindow ? \n        <div \n          className={styles.startWindow}\n          onKeyDown={e => e.keyCode === 13 ? startTheGame() : null}\n        >\n          <h1 className={styles.title}>Морской бой</h1>\n          <div className={styles.inputsWrap}>\n            <p>Размер корабля - 3 клетки</p>\n            <p>Размер доски: </p>\n            <Input\n              value={boardSize}\n              placeholder={'Размер доски'}\n              error={error}\n              onChangeInput={e => {setError(''); setBoardSize(e.target.value)}}\n            />\n            <p>Количество кораблей: </p>\n            <Input\n              value={shipAmount}\n              placeholder={'кораблей'}\n              error={error}\n              onChangeInput={e => {setError(''); setShipAmount(e.target.value)}}\n            />\n          </div>\n          <Button \n            text={'Начать игру'}\n            onClick={startTheGame}\n          />\n\n          {error && \n            <div className={styles.errorMessage}>\n              {error}\n            </div>\n          }\n        </div>\n      :\n        <Game \n          boardSize={boardSize}\n          shipLength={shipLength}\n          shipAmount={shipAmount}\n        />\n      }\n    </main>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}